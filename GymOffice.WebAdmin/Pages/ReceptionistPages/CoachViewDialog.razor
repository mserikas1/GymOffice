<MudDialog DefaultFocus="DefaultFocus.Element"> 
    <DialogContent>
    @if (coachModel == null)
    {
        <ErrorDisplay ErrorMessage="No data encountered!" ResetError="HandleResetError" />
    }
    else
    {
        <MudGrid>
            <MudItem xs="12" sm="@(coachModel!.PhotoUrl == null ? 12 : 7)">
                <MudCard Class="pa-2">
                    <MudCardContent>
                        <MudText Typo="Typo.subtitle2" Class="mb-3">Coach details:</MudText>
                        <MudTextField Label="First name" Variant="Variant.Outlined" Margin="Margin.Dense" ReadOnly="true" Value="coachModel!.FirstName" />
                        <MudTextField Label="Last name" Variant="Variant.Outlined" Margin="Margin.Dense" ReadOnly="true" Value="coachModel!.LastName" />
                        <MudTextField Label="Phone Number" Variant="Variant.Outlined" Margin="Margin.Dense" ReadOnly="true" Value="coachModel!.PhoneNumber" />
                        <MudTextField Label="Email" Variant="Variant.Outlined" Margin="Margin.Dense" ReadOnly="true" Value="coachModel!.Email" />
                        <MudTextField Label="Passport Number" Variant="Variant.Outlined" Margin="Margin.Dense" ReadOnly="true" Value="coachModel!.PassportNumber" />
                        <MudTextField Label="Education" Variant="Variant.Outlined" Margin="Margin.Dense" ReadOnly="true" Value="coachModel!.Education" />
                        <MudTextField Label="Desctiption" Variant="Variant.Outlined" Margin="Margin.Dense" ReadOnly="true" Lines="4"
                            Value="coachModel!.Description" />
                        <MudContainer Class="d-flex flex-row justify-center">
                            <MudItem sm="4" Class="mr-2">
                                <MudButton Variant="Variant.Text" Size="Size.Medium"
                                    StartIcon="@(coachModel!.IsActive ? Icons.Material.Filled.Done : Icons.Material.Filled.Close)" 
                                    Color="@(coachModel!.IsActive ? Color.Success : Color.Error)">
                                    @(coachModel!.IsActive ? "Active" : "Not active")
                                </MudButton>
                            </MudItem>
                            <MudItem sm="4">
                                <MudButton Variant="Variant.Text" Size="Size.Medium"
                                    StartIcon="@(coachModel!.IsAtWork ? Icons.Material.Filled.Done : Icons.Material.Filled.Close)" 
                                    Color="@(coachModel!.IsAtWork ? Color.Success : Color.Error)">
                                    @(coachModel!.IsAtWork ? "At work" : "Not at work")
                                </MudButton>
                            </MudItem>
                        </MudContainer>
                        <MudText><b>Group trainings:</b> @(coachModel!.GroupTrainings == null ? "None" : "View")</MudText>
                        <MudText><b>Individual trainings:</b> @(coachModel!.PersonalTrainings == null ? "None" : "View")</MudText>
                        <MudText><b>Work schedule:</b> @(coachModel!.JobScheduleItems == null ? "None" : "View")</MudText>
                        <MudDivider Class="my-2" />
                        <div class="d-flex flex-column">
                            <MudText><b>Created by:</b> @coachModel!.CreatedBy.Email</MudText>
                            <MudText><b>Created at:</b> @coachModel!.CreatedAt.ToShortDateString()</MudText>
                        </div>
                    </MudCardContent>
                </MudCard>
            </MudItem>
            @if (coachModel!.PhotoUrl != null)
            {
                <MudItem xs="12" sm="5">
                    <MudPaper Class="pa-2 mud-height-full">
                        <MudText Typo="Typo.subtitle2" Class="pa-2 mb-3">Profile Photo:</MudText>
                        <MudImage Fluid="true" Src="@coachModel!.PhotoUrl" Alt="Photo" Elevation="25" Class="rounded-lg" />
                    </MudPaper>
                </MudItem>
            }
        </MudGrid>
    }
    </DialogContent>
</MudDialog>

@code {
    [Parameter]
    public Coach? coachModel { get; set; }

    [CascadingParameter]
    MudDialogInstance? MudDialog { get; set; }

    // TODO redirecting to work schedule and trainings views

    private void HandleResetError()
    {
        MudDialog?.Close(DialogResult.Cancel);
    }
}