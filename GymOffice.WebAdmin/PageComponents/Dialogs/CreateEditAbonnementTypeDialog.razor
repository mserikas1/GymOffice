<MudDialog DefaultFocus="DefaultFocus.Element">
    <DialogContent>
        <EditForm Model="@AbonnementTypeModel" OnValidSubmit="HandleValidSubmit">
            <DataAnnotationsValidator />
            <MudGrid>
                <MudItem xs="12">
                    <MudCard Class="pa-3">
                        <MudText Typo="Typo.h6" Class="ms-5 mt-5">
                            @(IsEdit ? "Edit" : "Add New") Abonnement Type @(IsEdit ? $"\"{AbonnementTypeModel!.Name.ToUpper()}\"" : "")
                        </MudText>
                        <MudCardContent>
                            @if (IsEdit == false)
                            {
                                <MudFocusTrap Disabled="IsEdit">
                                    <MudTextField Label="Name" HelperText="@(IsEdit == true ? "" : "Length from 2 to 20 characters")"
                                              Variant="Variant.Outlined" Margin="Margin.Dense" Disabled="@IsEdit"
                                              @bind-Value="AbonnementTypeModel!.Name" For="@(() => AbonnementTypeModel!.Name)" />
                                </MudFocusTrap>
                            }

                            <div class="d-flex">
                                <MudSelect T="AbonnementDuration" Label="Duration" Margin="Margin.Dense" Dense="true"
                                           Variant="Variant.Outlined" Class="mt-3 me-5" Disabled="@IsEdit"
                                           @bind-Value="AbonnementTypeModel!.Duration">
                                    @foreach (AbonnementDuration item in Enum.GetValues(typeof(AbonnementDuration)))
                                    {
                                        <MudSelectItem Value="@item">@item</MudSelectItem>
                                    }
                                </MudSelect>
                                <MudNumericField Label="Price" Variant="Variant.Outlined" Margin="Margin.Dense"
                                                 Class="mt-3" Min="0.00M" Format="N2"
                                                 @bind-Value="AbonnementTypeModel!.Price" />
                                @if (IsEdit)
                                {
                                    <MudSelect T="bool" Label="Active" Margin="Margin.Dense" Dense="true"
                                           Variant="Variant.Outlined" Class="mt-3 ms-5"
                                           @bind-Value="AbonnementTypeModel!.IsActive" For="@(() => AbonnementTypeModel!.IsActive)">
                                        <MudSelectItem Value="@(true)">Yes</MudSelectItem>
                                        <MudSelectItem Value="@(false)">No</MudSelectItem>
                                    </MudSelect>
                                }
                            </div>


                            <div class="d-flex">
                                <MudTimePicker Label="Start visit time" Editable="true" Disabled="@IsEdit"
                                               @bind-Time="AbonnementTypeModel.StartVisitTime" />
                                <MudSpacer />
                                <MudTimePicker Label="End visit time" Editable="true" Disabled="@IsEdit"
                                               @bind-Time="AbonnementTypeModel.EndVisitTime" />
                            </div>

                            <MudTextField Label="Description" Class="mt-3" Lines="5"
                                          Variant="Variant.Outlined" Margin="Margin.Dense"
                                          @bind-Value="AbonnementTypeModel!.Description" For="@(() => AbonnementTypeModel!.Description)" />
                            @if (IsEdit)
                            {


                                <MudDivider Class="my-2" Light />
                                <div class="d-flex flex-column">
                                    <MudText><b>Created by:</b> @AbonnementTypeModel.CreatedBy.Email</MudText>
                                    <MudText><b>Created at:</b> @AbonnementTypeModel.CreatedAt.ToShortDateString()</MudText>
                                    @if (AbonnementTypeModel.CreatedAt.Day != AbonnementTypeModel.ModifiedAt.Day ||
                                         AbonnementTypeModel.CreatedBy != AbonnementTypeModel.ModifiedBy)
                                    {
                                        <MudText><b>Modified by:</b> @AbonnementTypeModel.ModifiedBy.Email</MudText>
                                        <MudText><b>Last Update:</b> @AbonnementTypeModel.ModifiedAt.ToShortDateString()</MudText>
                                    }
                                </div>
                            }
                        </MudCardContent>
                    </MudCard>
                </MudItem>
            </MudGrid>
            <MudCardActions Class="d-flex justify-end">
                <MudButton Variant="Variant.Filled" Color="Color.Default" Class="me-3" OnClick="HandleCancel">Cancel</MudButton>
                @if (IsEdit == false)
                {
                    <MudButton Variant="Variant.Filled" Color="Color.Default" Class="me-3" OnClick="HandleFormReset">Reset</MudButton>
                }
                <MudButton ButtonType="ButtonType.Submit" Variant="Variant.Filled" Color="Color.Primary">@(IsEdit == true ? "Update" : "Register")</MudButton>
                </MudCardActions>
            </EditForm>
        </DialogContent>
    </MudDialog>